---
layout: page
title: Building on Microsoft Windows
---

<div class="block">
	<p class="header">Building on Microsoft Windows</p>
    <p class="list"><a class="text" href="#Prerequisites">Prerequisites</a></p>
    <p class="list"><a class="text" href="#Preparation">Preparation</a></p>
    <p class="list"><a class="text" href="#BuildingFFmpeg">Building FFmpeg</a></p>
    <p class="list"><a class="text" href="#VisualStudio">Super Build</a></p>
    <p class="list"><a class="text" href="#SuperBuild">Super Build - Console</a></p>
</div>

<div class="block">
	<p class="header"><a name="Prerequisites">Prerequisites</a></p>
	<p>Check that you have the following software versions installed:</p>
	<ul>
	    <li><a class="text" href="https://www.microsoft.com/en-us/windows/get-windows-10">Windows 10</a></li>
		<li><a class="text" href="http://www.opengl.org">OpenGL</a> (version 4.1 or later)</li>
		<li><a class="text" href="https://visualstudio.microsoft.com">Visual Studio</a> (version 2017 or later)</li>
		<li><a class="text" href="https://cmake.org">CMake</a> (version 3.18 or later)</li>
		<li><a class="text" href="https://git-scm.com">git</a></li>
		<li><a class="text" href="https://www.nasm.us">NASM</a></li>
	</ul>
</div>

<div class="block">
	<p class="header"><a name="Preparation">Preparation</a></p>
    <p>Choose a directory to work in, this is where the code will be
    checked out and built. This directory will be referred to as DJV_BUILD
    in the rest of the documentation.</p>
	<p>Go to the build directory and clone the DJV git repository using the
    command prompt:</p>
	<pre>
> cd DJV_BUILD
> git clone https://github.com/darbyjohnston/DJV.git
</pre>
</div>

<div class="block">
	<p class="header"><a name="FFmpeg">Building FFmpeg</a></p>
    <p>Most of the third party software that DJV depends upon is built as part
    of the CMake super build, except for FFmpeg on Windows. To build FFmpeg on
    Windows the Windows Subsystem for Linux is used as a separate build step
    before the CMake super build. The following steps describe how to setup and
    use the Windows Subsystem for Linux.</p>
	<p>Enable the Windows Subsystem for Linux:</p>
	<ul>
		<li>Open the Windows control panel and click on "Programs and Features"</li>
		<li>Click on "Turn Windows features on or off" on the left side of the "Programs and Features" window</li>
		<li>Check the "Windows Subsystem for Linux" item in the "Windows Features" window</li>
		<li>Restart your computer</li>
		<li>Install Ubuntu from the Windows app store</li>
	</ul>
	<p>Start an Ubuntu shell and install some neccessary software:</p>
	<pre>
$ sudo apt update
$ sudo apt install mingw-w64 yasm make unzip
</pre>
	<p>Build FFmpeg:</p>
	<pre>
[Debug]

$ DJV_BUILD/DJV/etc/Windows/build_ffmpeg_wsl.sh DJV_BUILD/DJV-install-Debug
</pre>
	<pre>
[Release]

$ DJV_BUILD/DJV/etc/Windows/build_ffmpeg_wsl.sh DJV_BUILD/DJV-install-Release
</pre>
</div>

<div class="block">
	<p class="header"><a name="SuperBuild">Super Build</a></p>
	<p>The CMake super build builds both DJV and the third party software that
    DJV depends upon.</p>
	<p>Setup environment variables:</p>
	<pre>
[Debug]

> set DJV_BUILD=%CD%
> set PATH=%DJV_BUILD%\DJV-install-Debug\bin;%PATH%
</pre>
	<pre>
[Release]

> set DJV_BUILD=%CD%
> set PATH=%DJV_BUILD%\DJV-install-Release\bin;%PATH%
</pre>
	<p>Create a directory for the build and run CMake:</p>
	<pre>
[Debug]

> mkdir DJV-Debug
> cd DJV-Debug
> cmake ..\DJV\etc\SuperBuild -DCMAKE_BUILD_TYPE=Debug -DCMAKE_INSTALL_PREFIX=%DJV_BUILD%/DJV-install-Debug -DCMAKE_PREFIX_PATH=%DJV_BUILD%/DJV-install-Debug
</pre>
	<pre>
[Release]

> mkdir DJV-Release
> cd DJV-Release
> cmake ..\DJV\etc\SuperBuild -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=%DJV_BUILD%/DJV-install-Release -DCMAKE_PREFIX_PATH=%DJV_BUILD%/DJV-install-Release
</pre>
<p>Start the build:</p>
	<pre>
[Debug]

> cmake --build . --config Debug -j
</pre>
	<pre>
[Release]

> cmake --build . --config Release -j
</pre>
	<p>Try running the DJV player application:</p>
	<pre>
[Debug]

> DJV\src\DJV-build\build\bin\Debug\djv
</pre>
	<pre>
[Release]

> DJV\src\DJV-build\build\bin\Release\djv
</pre>
    <p>When developing DJV with a super build you can speed up build times
    by skipping the third party dependencies. Note that you must have
    built the thirty party dependencies first:</p>
    <pre>
[Debug]

> cd DJV\src\DJV-build
> cmake --build . --config Debug -j
</pre>
    <pre>
[Release]

> cd DJV\src\DJV-build
> cmake --build . --config Release -j
</pre>
</div>

<div class="block">
	<p class="header"><a name="VisualStudio">Visual Studio</a></p>
	<p>DJV can also be built with Visual Studio solutions using the appropriate
	CMake generator, for example "Visual Studio 16 2019".</p>
    <p>Make sure the solution configuration is set to the same value as configured
    with CMake ("Debug", "Release", etc.).</p>
    <p>Note that if you are using Visual Studio solutions and get the error:</p>
    <pre>
LINK : fatal error LNK1104: cannot open file 'djv.ilk' [djv..vcxproj]
</pre>
    <p>Run the build a second time and the error should go away.</p>
</div>

